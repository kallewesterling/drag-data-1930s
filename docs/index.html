<!DOCTYPE html>
<html class="theme-light">
    <head>
        <script src="https://d3js.org/d3.v5.min.js"></script>
        <!--<script src="https://d3js.org/d3.v6.min.js"></script>-->
        <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-CuOF+2SnTUfTwSZjCXf01h7uYhfOBuxIhGKPbfEJ3+FqH/s6cIFN9bGr1HmAg4fQ" crossorigin="anonymous">
        <link rel="stylesheet" href="css/themes.css">
        <link rel="stylesheet" href="css/style.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.0/font/bootstrap-icons.css">
        <script src="https://unpkg.com/topojson@3"></script>
        <title>U.S. Drag in the 1930s</title>
    </head>
    <body>
        <nav class="px-3 navbar navbar-expand-xl navbar-light justify-content-between shadow-sm border-bottom">
            <section class="d-flex">
                <a data-bs-toggle="modal" data-bs-target="#rationale" data-bs-keyboard="true" type="button" class="order-1 btn btn-sm btn-outline-success mr-3"><i class="bi bi-patch-question-fill mr-md-1"></i><span class="d-none d-md-inline-block">Rationale</span></a>
                <a id="showEntireDataset" class="order-2 btn btn-sm btn-outline-success mr-3" href="https://docs.google.com/spreadsheets/d/1UlpFQ9WWA6_6X-RuMJ3vHdIbyqhCZ1VRYgcQYjXprAg/edit#gid=0" target="_blank"><i class="bi bi-file-earmark-spreadsheet-fill mr-md-1"></i><span class="d-none d-md-inline-block">Dataset</span></a>
                <a id="switchMode" class="order-md-3 order-0 btn btn-sm btn-outline-secondary mr-3"></a>
                <a id="nudgeNodes" class="order-4 btn btn-sm btn-outline-secondary mr-3"><i class="bi bi-unlock-fill mr-md-1"></i><span class="d-none d-md-inline-block">Fix stuck nodes</span></a>
                <a id="resetLocalStorage" class="order-5 btn btn-sm btn-outline-secondary mr-3"><i class="bi bi-cloud-slash-fill mr-md-1"></i><span class="d-none d-md-inline-block">Reset settings</span></a>
                <a id="showClusterInfo" class="order-5 btn btn-sm btn-outline-secondary"><i class="bi bi-triangle-fill mr-md-1"></i><span class="d-none d-md-inline-block">Community details</span></a>
            </section>
            <div class="collapse navbar-collapse" id="navbarSupportedContent" style="width:auto; max-width:100%">
                <div id="info" class="d-flex align-items-center">
                    <span id="" class="numNodes small mr-3" data-bs-trigger="click" data-bs-toggle="popover" title="Number of nodes" data-bs-content='The numbers here show <strong>number of current nodes</strong>/number of all nodes in the graph. It is an indicator of how much the graph you are seeing has been filtered. You can change the filtering of the edges under the "Node filtering" section in the "Settings" below.'><i class="mr-1 small bi bi-record-fill"></i></span>
                    <span id="" class="numEdges small mr-3" data-bs-trigger="click" data-bs-toggle="popover" title="Number of edges" data-bs-content='The numbers here show <strong>number of current edges</strong>/number of all edges in the graph. It is an indicator of how much the graph you are seeing has been filtered. You can change the filtering of the edges under the "Edge filtering" section in the "Settings" below.'><i class="mr-1 small bi bi-share-fill"></i></span>
                    <span id="" class="unconnectedNodes small mr-3" data-bs-trigger="click" data-bs-toggle="popover" title="Number of unconnected nodes" data-bs-content='The number here shows how many nodes are present in the current graph you are seeing that are unconnected from one another. If you have "auto-clear unconnected nodes" turned on in the "Node filtering" settings, this number should always stay at 0 since any lingering unconnected nodes are removed on rendering.'><i class="mr-1 bi bi-node-minus"></i></span>
                    <span id="" class="currentZoom small mr-3" data-bs-trigger="click" data-bs-toggle="popover" title="Current zoom level" data-bs-content='This number shows you how scaled the current graph is, between 60–400%.'></span>
                    <span id="" class="numCommunities small mr-3" data-bs-trigger="click" data-bs-toggle="popover" title="Number of communities" data-bs-content='The number that you see here shows how many number of communities have been identified in the graph you are currently seeing. The algorithm used is the Levain clustering algorithm, which you can read more about under the "Rationale". Click the button furthest to the left in the menubar if you are more interested.'></span>
                    <span id="" class="colorNetworks mr-3 m-0 badge" data-bs-trigger="hover" data-bs-toggle="popover" title="Number of networks" data-bs-content='The number here shows how many disconnected networks are present in the current graph. The fewer the networks, the higher degree of connection between all the nodes. Click the button to color the nodes after which network they belong to. When the coloring is activated, this button will be yellow.'></span>
                    <span id="" class="commentedNodes m-0 badge" data-bs-trigger="hover" data-bs-toggle="popover" title="Number of commented nodes" data-bs-content='The number of nodes in the current graph that has a comment assigned to them. If you want to show only the nodes that have comments assigned to them and see how they relate to one another, click this button. When this view is activated, this button will be yellow.'></span>
                </div>
            </div>
        </nav>
        <div id="floatingInfo" class="d-flex flex-column p-2 rounded-3 border">
            <span id="" class="numNodes small mr-3 text-muted" data-bs-trigger="click" data-bs-toggle="popover" title="Number of nodes" data-bs-content='The numbers here show <strong>number of current nodes</strong>/number of all nodes in the graph. It is an indicator of how much the graph you are seeing has been filtered. You can change the filtering of the edges under the "Node filtering" section in the "Settings" below.'><i class="mr-1 small bi bi-record-fill"></i></span>
            <span id="" class="numEdges small mr-3 text-muted" data-bs-trigger="click" data-bs-toggle="popover" title="Number of edges" data-bs-content='The numbers here show <strong>number of current edges</strong>/number of all edges in the graph. It is an indicator of how much the graph you are seeing has been filtered. You can change the filtering of the edges under the "Edge filtering" section in the "Settings" below.'><i class="mr-1 small bi bi-share-fill"></i></span>
            <span id="" class="unconnectedNodes small mr-3 text-muted" data-bs-trigger="click" data-bs-toggle="popover" title="Number of unconnected nodes" data-bs-content='The number here shows how many nodes are present in the current graph you are seeing that are unconnected from one another. If you have "auto-clear unconnected nodes" turned on in the "Node filtering" settings, this number should always stay at 0 since any lingering unconnected nodes are removed on rendering.'><i class="mr-1 bi bi-node-minus"></i></span>
            <span id="" class="currentZoom small mr-3 text-muted" data-bs-trigger="click" data-bs-toggle="popover" title="Current zoom level" data-bs-content='This number shows you how scaled the current graph is, between 60–400%.'></span>
            <span id="" class="numCommunities small mr-3 text-muted" data-bs-trigger="click" data-bs-toggle="popover" title="Number of communities" data-bs-content='The number that you see here shows how many number of communities have been identified in the graph you are currently seeing. The algorithm used is the Levain clustering algorithm, which you can read more about under the "Rationale". Click the button furthest to the left in the menubar if you are more interested.'></span>
        </div>
        <div class="modal" id="numberModal">
            <div class="modal-dialog modal-dialog-centered justify-content-center">
                <div class="modal-content w-auto shadow-lg">
                    <div class="modal-body">
                        <h5></h5>
                        <h1></h1>
                    </div>
                </div>
            </div>
        </div>
        <div id="nodeTable" class="w-100 d-flex justify-content-center d-none">
            <div id="nodeTableContainer">
                <table class="table" class="">
                    <thead>
                    <tr>
                        <th scope="col" id="nodeTableHeader1">C#</th>
                        <th scope="col" id="nodeTableHeader2">N#</th>
                        <th scope="col" id="nodeTableHeader3">Performers</th>
                        <th scope="col" id="nodeTableHeader4">Venues</th>
                        <th scope="col" id="nodeTableHeader5">Cities</th>
                    </tr>
                    </thead>
                    <tbody id="appendHere"></tbody>
                </table>
            </div>
        </div>
        <div id="rationale" class="modal">
            <div class="modal-dialog modal-xl modal-fullscreen-xxl-down">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Rationale</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-12 col-md">
                                <h1 class="h3">Header</h1>
                                <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Sint impedit tenetur vel provident! Minima ratione repellat voluptates, quisquam, assumenda error voluptatem quidem, tenetur saepe itaque repellendus possimus optio alias ut?</p>

                                <h2 class="h5">Keyboard Shortcuts</h2>
                                <div class="row">
                                    <div class="col-1">
                                        <kbd>esc</kbd>
                                    </div>
                                    <div class="col">
                                        <p>Hide the frontmost element. When this information window (which you're currently looking at) is showing, it will hide this window. If you're in the network visualization screen, it will toggle the visibility of the setting boxes.</p>
                                    </div>
                                    <div class="col-1 border-left">
                                        <kbd>&#8679;</kbd><kbd>&#8592;</kbd> or<br />
                                        <kbd>&#8679;</kbd><kbd>&#8594;</kbd>
                                    </div>
                                    <div class="col">
                                        <p>Adjust edge's minimum weight up and down. <strong>What does that mean?</strong></p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 col-md-3 d-flex flex-column" id="dashboard">
                                <h1 class="h3">Dashboard</h1>
                                <div class="rounded border mb-2 p-1">
                                    <p class="fw-bold">Number of nodes</p>
                                    <p class="mb-2">257</p>
                                    <p><small class="text-muted">Explanation here</small></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="wrapToasters"></div>
        <div id="settings" class="small card shadow-sm border rounded-3">
            <div class="card-header d-flex justify-content-between align-items-center" id="settingsToggle">
                <span><i class="bi bi-gear mr-2"></i>Settings</span>
                <span id="toggledSettings"></i></span>
            </div>
            <ul id="settingsContainer" class="list-group list-group-flush">
                <li class="list-group-item" id="datafileContainer">
                    <div class="mb-2">
                        <p class="small text-muted p-0 m-0 fw-bold" data-toggle="datafileToggle">Data file</p>
                    </div>
                    <div class="mb-2 d-none" id="datafileToggle">
                        <select id="datafile">
                            <option value="data/new-relations.json">co-occurrence</option>
                            <option value="data/multipartite-data.json">multi-partite graph</option>
                            <option value="data/bipartite-data-performer-city.json">bipartite graph (performer-city)</option>
                            <option value="data/bipartite-data-performer-venue.json">bipartite graph (performer-venue)</option>
                        </select>
                    </div>
                </li>
                <li class="list-group-item">
                    <div class="mb-2">
                        <p class="small text-muted p-0 m-0 fw-bold">Node filtering</p>
                    </div>
                    <div class="mb-2">
                        <input class="p-0 m-0" type="range" id="minDegree" name="minDegree" min="1" max="40" value="1" step="1">
                        <label class="small p-0 m-0" for="minDegree" id="minDegree_label">minDegree</label>
                        <span class="text-nowrap small metaShow d-none"><key class="small rounded ml-1 bg-success text-white p-1 fw-bold">&#8592;</key><key class="rounded small ml-1 bg-success text-white p-1 fw-bold">&#8594;</key></span>
                    </div>
                    <div class="mb-2">
                        <p class="small text-muted p-0 m-0 fw-bold">sizing</p>
                    </div>
                    <div class="mb-2">
                        <input class="p-0 m-0" type="range" id="nodeMultiplier" name="nodeMultiplier" min="1" max="40" value="1" step="1">
                        <label class="small p-0 m-0" for="nodeMultiplier" id="nodeMultiplier_label">size nodeMultiplier</label>
                        <span class="text-nowrap small metaShow d-none"><key class="rounded small ml-1 bg-success text-white p-1 fw-bold">+</key><key class="rounded small ml-1 bg-success text-white p-1 fw-bold">-</key></span>
                    </div>
                    <div class="mt-3 mb-2">
                        <p class="mb-1 text-muted small fw-bold">behavior</p>
                    </div>
                    <div class="mb-2">
                        <p class="m-0">
                            <label class="mr-1" for="autoClearNodes"><input type="checkbox" id="autoClearNodes"> auto-clear unconnected nodes</label>
                            <span class="text-nowrap small metaShow d-none"><key class="rounded small ml-1 bg-success text-white p-1 fw-bold">&#8984; + C</key></span>
                        </p>
                    </div>
                    <div class="mb-2">
                        <label class="mr-1" for="stickyNodes"><input type="checkbox" id="stickyNodes"> stickyNodes</label>
                    </div>
                    <div class="mb-2">
                        <label class="mr-1" for="nodeSizeFromCurrent"><input type="checkbox" id="nodeSizeFromCurrent"> node size from current graph</label>
                        <span class="text-nowrap small metaShow d-none"><key class="rounded small ml-1 bg-success text-white p-1 fw-bold">&#8679; + N</key></span>
                    </div>
                    <div class="mt-3 mb-2">
                        <p class="mb-1 text-muted small fw-bold">Detect communities</p>
                    </div>
                    <div class="mb-2">
                        <label class="small p-0 m-0" for="communityDetection">algorithm</label>
                        <select id="communityDetection"></select>
                    </div>

                    <!--
                    <div class="mb-2">
                        <label class="mr-1" for="communityDetection"><input type="checkbox" id="communityDetection"> community detection</label>
                    </div>
                    -->
                </li>

                <li class="list-group-item">
                    <div class="mb-2">
                        <p class="small text-muted p-0 m-0 fw-bold">Edge filtering</p>
                    </div>
                    <div class="mb-2">
                        <input class="p-0 m-0" type="range" id="minWeight" name="minWeight" min="0" max="40" value="1" step="1">
                        <label class="small p-0 m-0" for="minWeight" id="minWeight_label">minWeight</label>
                        <span class="text-nowrap small metaShow d-none"><key class="rounded small ml-1 bg-success text-white p-1 fw-bold">&#8679; + &#8592;</key><key class="rounded small ml-1 bg-success text-white p-1 fw-bold">&#8679; + &#8594;</key></span>
                    </div>
                    <div class="mb-2">
                        <p class="small text-muted p-0 m-0 fw-bold">sizing</p>
                    </div>
                    <div class="mb-2">
                        <input class="p-0 m-0" type="range" id="edgeMultiplier" name="edgeMultiplier" min="1" max="40" value="1" step="1">
                        <label class="small p-0 m-0" for="edgeMultiplier" id="edgeMultiplier_label">size edgeMultiplier</label>
                        <span class="text-nowrap small metaShow d-none"><key class="rounded small ml-1 bg-success text-white p-1 fw-bold">+</key><key class="rounded small ml-1 bg-success text-white p-1 fw-bold">-</key></span>
                    </div>
                    <div class="mb-2">
                        <label class="small p-0 m-0" for="startYear">startYear</label>
                        <select id="startYear"></select>
                        <label class="small p-0 m-0" for="startYear">endYear</label>
                        <select id="endYear"></select>
                    </div>
                    <div class="mt-3 mb-2">
                        <p class="mb-1 text-muted small fw-bold">behavior</p>
                    </div>
                    <div class="mb-2">
                        <label class="mr-1" for="weightFromCurrent"><input type="checkbox" id="weightFromCurrent"> determine weight from current graph</label>
                    </div>
                </li>

                <li class="list-group-item">
                    <div class="mb-2">
                        <p class="small text-muted p-0 m-0 fw-bold" data-toggle="forceToggle">Force settings</p>
                    </div>
                    <div class="mb-2 d-none" id="forceToggle">
                        <div class="mb-2">
                            <p class="m-0">
                                <label class="mr-1" for="layoutCenter"><input type="checkbox" id="layoutCenter"> center</label>
                                <label class="mr-1" for="layoutForceX"><input type="checkbox" id="layoutForceX"> forceX</label>
                                <label class="mr-1" for="layoutForceY"><input type="checkbox" id="layoutForceY"> forceY</label>
                            </p>
                            <p class="m-0">
                                <label class="mr-1" for="layoutCollide"><input type="checkbox" id="layoutCollide"> collide</label>
                                <label class="mr-1" for="layoutCharge"><input type="checkbox" id="layoutCharge"> charge</label>
                            </p>
                        </div>
                        <div class="mb-2" id="chargeContainer">
                            <input class="p-0 m-0" type="range" id="charge" name="charge" min="1" max="40" value="1" step="1">
                            <label class="small p-0 m-0" for="charge" id="charge_label">charge</label>
                            <span class="text-nowrap small metaShow d-none"><key class="small rounded ml-1 bg-success text-white p-1 fw-bold">&#8593;</key><key class="rounded small ml-1 bg-success text-white p-1 fw-bold">&#8595;</key></span>
                        </div>
                        <div class="mb-2" id="collideContainer">
                            <input class="p-0 m-0" type="range" id="collide" name="collide" min="1" max="40" value="1" step="1">
                            <label class="small p-0 m-0" for="collide" id="collide_label">collide</label>
                        </div>
                        <div class="mb-2" id="linkStrengthContainer">
                            <input class="p-0 m-0" type="range" id="linkStrength" name="linkStrength" min="1" max="40" value="1" step="1">
                            <label class="small p-0 m-0" for="linkStrength" id="linkStrength_label">linkStrength</label>
                        </div>
                        <div class="mb-2">
                            <p class="m-0">
                                <label class="mr-1" for="layoutClustering"><input type="checkbox" id="layoutClustering"> clustering</label>
                            </p>
                        </div>
                    </div>
                </li>

                <li class="list-group-item">
                    <div class="mb-2">
                        <p class="small text-muted p-0 m-0 fw-bold" data-toggle="debugToggle">Debug</p>
                    </div>
                    <div class="mb-2 d-none" id="debugToggle">
                        <label class="mr-1" for="debugMessages"><input type="checkbox" id="debugMessages"> debugMessages</label>
                    </div>
                </li>
            </ul>
        </div>
        <div id="infoContainer"></div>
        <div id="nodeEdgeInfo" class="card small shadow-sm border rounded-3 d-none">
            <div class="card-header d-flex justify-content-between align-items-center" id="infoToggleDiv">
                <span><i class="bi bi-share-fill mr-2"></i>Node/Edge information</span>
            </div>
            <div id="nodeEdgeInfoContainer" class="">
                <ul class="list-group list-group-flush"></ul>
            </div>
        </div>
        <div id="previewData" class="small shadow-sm border p-3 rounded-3 d-none"><svg id="preview"></svg></div>

        <div id="loading" class="h-100 d-flex justify-content-center">
            <div id="loadingContainer" class="my-auto p-4 bg-white rounded shadow-lg d-flex flex-column">
                <div id="loadingMessage"></div>
                <div class="text-center" id="loadingSpinner">
                    <div class="spinner-grow mt-2" role="status"></div>
                </div>
            </div>
        </div>

        <svg id="main" width="100%" height="100%">
            <g id="background"><rect x="-100%" y="-100%" width="200%" height="200%" fill="rgba(0, 0, 0, 0.009)"></rect></g>
        </svg>
        

        <div id="popup-info" class="d-none shadow-lg"></div>
        <div id="egoNetwork" class="d-none shadow-lg p-2 text-center bg-warning">Ego network for node <span id="node">NODE</span>.<i id="closeEgoNetwork" class="ml-3 bi bi-stop-circle"></i></div>
    
        <!--<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>-->
        <script src="core/models/Edge.js"></script>
        <script src="core/utils/debug.js"></script>
        <script src="core/settings.js"></script>
        <script src="core/regex.js"></script>
        <script src="core/theme.js"></script>
        <script src="core/setup.js"></script>
        <script src="core/utils/general.js"></script>
        <script src="core/utils/text.js"></script>
        <script src="core/utils/visibility.js"></script>
        <script src="core/utils/community-detection-algorithms/jlouvain.js"></script>
        <script src="core/utils/community-detection.js"></script>
        <script src="core/scales.js"></script>
        <script src="core/filters.js"></script>
        <script src="core/load.js"></script>
        <script src="core/zoom.js"></script>
        <script src="core/app.js"></script>
        
        <script src="core/geo.js"></script>
        <script src="core/tour.js"></script>

        <!-- TODO: a different app... so another project. Maybe it should just be a different page altogether -->
        <script src="preview-app/previewData.js"></script>

        <!-- JavaScript Bundle with Popper -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js" integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" crossorigin="anonymous"></script>

        <script>
            var popoverTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'));
            var popoverList = popoverTriggerList.map(function (popoverTriggerEl) {
                let options = {'placement': 'bottom', 'html': true};
                new bootstrap.Popover(popoverTriggerEl, options);
            });
        </script>
    </body>
</html>
